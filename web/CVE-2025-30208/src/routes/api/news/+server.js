
// Mock data - in production, this would come from a database
const mockArticles = [
  {
    id: '1',
    title: 'Revolutionary AI Breakthrough Transforms Healthcare Industry',
    excerpt: 'Scientists announce a major advancement in artificial intelligence that could revolutionize medical diagnosis and treatment planning, potentially saving millions of lives worldwide.',
    content: 'Full article content here...',
    author: 'Sarah Johnson',
    publishedAt: '2024-01-15T10:00:00Z',
    category: 'Technology',
    imageUrl: '/robot.jpeg',
    featured: true,
    readTime: 5
  },
  {
    id: '2',
    title: 'Global Climate Summit Reaches Historic Agreement',
    excerpt: 'World leaders commit to ambitious new targets for carbon reduction, marking a significant step forward in the fight against climate change.',
    content: 'Full article content here...',
    author: 'Michael Chen',
    publishedAt: '2024-01-15T08:30:00Z',
    category: 'Science',
    imageUrl: '/robot.jpeg',
    featured: false,
    readTime: 3
  },
  {
    id: '3',
    title: 'Stock Markets Reach All-Time Highs Amid Economic Recovery',
    excerpt: 'Major indices surge as investors show renewed confidence in economic growth prospects following positive employment data.',
    content: 'Full article content here...',
    author: 'Emily Rodriguez',
    publishedAt: '2024-01-15T07:15:00Z',
    category: 'Business',
    imageUrl: '/robot.jpeg',
    featured: false,
    readTime: 4
  },
  {
    id: '4',
    title: 'Breakthrough in Renewable Energy Storage Technology',
    excerpt: 'New battery technology promises to solve one of the biggest challenges facing renewable energy adoption, making solar and wind power more reliable than ever.',
    content: 'Full article content here...',
    author: 'David Kim',
    publishedAt: '2024-01-14T16:45:00Z',
    category: 'Technology',
    imageUrl: '/robot.jpeg',
    featured: false,
    readTime: 6
  },
  {
    id: '5',
    title: 'Olympic Committee Announces New Sports for 2028 Games',
    excerpt: 'Several exciting new sports will make their debut in Los Angeles, reflecting changing global interests and youth participation trends.',
    content: 'Full article content here...',
    author: 'Alex Thompson',
    publishedAt: '2024-01-14T14:20:00Z',
    category: 'Sports',
    imageUrl: '/robot.jpeg',
    featured: false,
    readTime: 3
  },
  {
    id: '6',
    title: 'Medical Study Reveals Surprising Benefits of Mediterranean Diet',
    excerpt: 'Comprehensive research shows significant improvements in heart health and cognitive function among participants following traditional Mediterranean eating patterns.',
    content: 'Full article content here...',
    author: 'Dr. Lisa Martinez',
    publishedAt: '2024-01-14T11:00:00Z',
    category: 'Health',
    imageUrl: '/robot.jpeg',
    featured: false,
    readTime: 7
  },
  {
    id: '7',
    title: 'Tech Giants Announce Partnership for Quantum Computing Research',
    excerpt: 'Leading technology companies join forces to accelerate quantum computing development, promising breakthroughs in cryptography and drug discovery.',
    content: 'Full article content here...',
    author: 'Rachel Green',
    publishedAt: '2024-01-14T09:30:00Z',
    category: 'Technology',
    imageUrl: '/robot.jpeg',
    featured: false,
    readTime: 5
  },
  {
    id: '8',
    title: 'New Film Festival Celebrates Independent Cinema Worldwide',
    excerpt: 'International film festival showcases emerging talent and diverse storytelling, connecting filmmakers with global audiences.',
    content: 'Full article content here...',
    author: 'James Wilson',
    publishedAt: '2024-01-13T18:00:00Z',
    category: 'Entertainment',
    imageUrl: '/robot.jpeg',
    featured: false,
    readTime: 4
  },
  {
    id: '9',
    title: 'Central Bank Signals Interest Rate Changes Amid Economic Shifts',
    excerpt: 'Federal Reserve announces potential adjustments to monetary policy in response to changing inflation and employment metrics.',
    content: 'Full article content here...',
    author: 'Maria Garcia',
    publishedAt: '2024-01-13T15:45:00Z',
    category: 'Business',
    imageUrl: '/robot.jpeg',
    featured: false,
    readTime: 6
  }
];

export const GET = async ({ url }) => {
  const category = url.searchParams.get('category');
  const search = url.searchParams.get('search');
  const limit = parseInt(url.searchParams.get('limit') || '10');
  const offset = parseInt(url.searchParams.get('offset') || '0');
  
  let filteredArticles = [...mockArticles];
  
  // Filter by category
  if (category && category !== 'all') {
    filteredArticles = filteredArticles.filter(article => 
      article.category.toLowerCase() === category.toLowerCase()
    );
  }
  
  // Filter by search term
  if (search) {
    const searchLower = search.toLowerCase();
    filteredArticles = filteredArticles.filter(article => 
      article.title.toLowerCase().includes(searchLower) ||
      article.excerpt.toLowerCase().includes(searchLower) ||
      article.content.toLowerCase().includes(searchLower)
    );
  }
  
  // Sort by date (newest first)
  filteredArticles.sort((a, b) => 
    new Date(b.publishedAt).getTime() - new Date(a.publishedAt).getTime()
  );
  
  // Apply pagination
  const paginatedArticles = filteredArticles.slice(offset, offset + limit);
  
  return new Response(JSON.stringify({
    articles: paginatedArticles,
    total: filteredArticles.length,
    hasMore: offset + limit < filteredArticles.length,
    category,
    search
  }), {
    headers: {
      'Content-Type': 'application/json',
      'Cache-Control': 'public, max-age=300' // Cache for 5 minutes
    }
  });
};

export const POST = async ({ request }) => {
  const data = await request.json();
  
  // In a real app, this would save to a database
  const newArticle = {
    id: Date.now().toString(),
    ...data,
    publishedAt: new Date().toISOString(),
    featured: false
  };
  
  mockArticles.push(newArticle);
  
  return new Response(JSON.stringify(newArticle), {
    status: 201,
    headers: {
      'Content-Type': 'application/json'
    }
  });
};
